## 먼저 생각해본 좋은 파일 구조의 기준

미리 생각해본 좋은 파일 구조의 기준에 대해 이야기해보자면 아래와 같다.

> 좋은 파일 구조의 기준
>
> 1.  각각의 폴더는 컴포넌트가 담기는 명확한 기준을 갖고 있어야 한다.
> 2.  파일이 어느 위치에 있을지 쉽게 유추할 수 있어야 한다.
> 3.  유지보수가 쉬워야 하고 생산성을 높여줘야 한다.
> 4.  파일 구조를 보았을 때 직관적으로 파악이 되어야하고 가독성이 좋아야 한다.

### 각각의 폴더는 컴포넌트가 담기는 명확한 기준을 갖고 있어야 한다.

너무나도 당연한 이야기이지만 이게 생각보다 어렵다.

먼저 폴더의 명확한 기준에 대해 생각해보자면, 사실 아래와 같은 폴더들은 명확한 기준을 갖고 담고 있어서 별로 고민할 필요는 없다.

```bash
# 아래는 React 폴더 구조를 기본으로 했으며 그냥 현재 내가 사용하는 방식이다.

📦src
 ┣ 📂api # api 관련 함수를 담은 코드
 ┣ 📂constants # 유용한 상수들을 담은 코드
 ┣ 📂data # 변경 가능한 상태 데이터를 담는 코드
 ┣ 📂hooks # 커스텀 훅 폴더
 ┣ 📂routes # 라우트 페이지들을 담은 폴더
 ┣ 📂theme # 스타일 관련 폴더
 ┗ 📂util # 전역에서 사용 가능한 유용한 함수 모듈들을 담은 폴더
```

위와 같은 폴더들은 사실 기준이 너무나도 명확하다. 여기에서 조금씩 이름만 달라지는 것인데, 예를 들어 나는 상태 관리 라이브러리로 redux toolkit을 사용한다면 📂data 대신 📂redux 로 이름을 변경한다. 다른 사람들은 라이브러리라는 뜻으로 📂lib이라고 이름짓는 사람들도 많다. 또한 next.js에서는 📂routes 대신 📂pages 이름을 사용한다.

이렇게 이름은 달라질 수 있지만 사실 파일이 담기는 기준은 같다.

그래서 위와 같은 경우는 별로 고민이 되지 않지만, 고민이 되는 경우는 바로 **components** 폴더다.

```bash
📦src
 ┣ 📂api # api 관련 함수를 담은 코드
 ┣ 📂constants # 유용한 상수들을 담은 코드
 ┣ 📂components # 여기는 좀 기준이...?
 ┣ 📂data # 변경 가능한 상태 데이터를 담는 코드
 ┣ 📂hooks # 커스텀 훅 폴더
 ┣ 📂routes # 라우트 페이지들을 담은 폴더
 ┣ 📂theme # 스타일 관련 폴더
 ┗ 📂util # 전역에서 사용 가능한 유용한 함수 모듈들을 담은 폴더
```

사실 여러개의 프로젝트를 진행하면서 점점 프로젝트의 단위가 커졌는데, 그러면서 다양한 파일 구조를 사용해본 것 같다. 그속에서 느낀 점들을 작성하고 무엇이 가장 좋은 파일 구조일까에 대해 고민한 점들을 작성해보려고 한다.

## 라우트 기반 파일 구조

라우트(경로) 기반 파일 구조는 말 그대로 경로별로 폴더를 이름짓고 컴포넌트를 구분한다는 것을 뜻한다.

처음 개발을 시작하며 가장 많은 사람들이 사용하는 파일 구조가 아닐까 싶다. 그렇다고 입문자들이 사용하는 파일 구조라는 뜻이 아니다. 지금은 업데이트 되고 있지 않은 [React 공식문서 파일 구조](https://ko.legacy.reactjs.org/docs/faq-structure.html#gatsby-focus-wrapper)에서도 이 라우트 기반 파일 구조에 대해 설명했었다.

어쨌든 간 효율적인 파일 구조란 파일이 명확한 기준을 갖고 있는 폴더에 제대로 담겨있어서 원하는 파일을 쉽게 찾아낼 수 있는 것 아니겠는가? 그런면에서 라우트 기반 파일 구조가 일단 가장 명확한 기준을 갖고 있는 폴더인 건 부정할 수 없을 것 같다.

### 라우트 기반 파일 구조를 활용한 경험

현재 이 개발 블로그는 이 라우트 기반 파일 구조를 활용했다. 이 개발 블로그 프로젝트는 Next.js로 구현했는데, Next.js는 전체 페이지는 **app**이라는 폴더에 놓고 있고, 전체 페이지에서 사용되는 컴포넌트들은 경로 이름 별로 폴더를 구분하고 있다.

```bash
📦components
 ┣ 📂about
 ┣ 📂common
 ┣ 📂home
 ┣ 📂layout
 ┣ 📂posts
```

이 폴더들의 기준은 너무나도 명확하고 또 간결하다.

- 📂about, 📂home, 📂posts 라우트 페이지에 쓰이는 컴포넌트는 각 이름에 맞는 폴더로
- 여러 페이지에 공통으로 여러번 쓰일 수 있는 컴포넌트는 📂common 폴더로
- 모든 페이지에 공통으로 나타나야 하는 컴포넌트는 📂layout 폴더로
  - 📂header 📂footer 컴포넌트 같은 것들

그러니까 이 컴포넌트는 어느 폴더로 들어가야하지? 라는 고민을 단 한번도 한 적이 없었다.

### 그런데 라우트 기반 파일 구조가 불편했던 이유

좋은 파일 구조가 폴더에 명확한 기준만 있다고 되는 것이 아니었다. 파일 구조에서 명확한 기준은 기본값이고, 거기에 보태 **유지보수와 생산성을 더 좋게** 만들어줘야 하는 것이었다.

개발 블로그에서 라우트 기반 파일 구조가 잘 맞았던 것은 그 라우트가 많이 없었기 때문이다. 공통 컴포넌트를 제외하면 📂about, 📂home, 📂posts 이렇게 3가지 뿐이다.

다른 프로젝트였던 독서모임 한페이지 기록앱을 개발하며 경로가 10개가 넘어가기 시작하니까 라우트 기반 파일 구조는 생산성이 떨어지기 시작했다. 아래는 실제 했던 고민들이다.

- 🤔그럼 경로가 하나 생길때마다 폴더가 추가되어야 하는 건가? 파일보다 폴더 찾는게 더 힘든게 맞나?
- 🤔폴더 하나에 컴포넌트 하나만 담기는 경우가 생기기도 하는데, 굉장히 비효율적인데…이게 맞나?
- 🤔공통으로 사용될 것 같으면 📂common 폴더로 넣는데, 이 📂common의 기준이 점점 희미해지고 있는 것 같다. 같이 사용된다고 간단한 버튼 컴포넌트랑 복잡한 전체 폼 컴포넌트가 같이 있는게 맞나?
- 🤔여러 페이지에서 사용되다가 다시 하나의 페이지에서만 사용되는 컴포넌트라면 다시 해당 라우트 폴더에 옮겨야 하나? 반대의 경우에도?

더 많은 고민을 했던 것 같은데 여기까지 적어야겠다. 이렇게 컴포넌트 하나가 생길 때마다 위와 같은 고민을 반복하니까 자연히 생산성이 떨어졌다.

확실히 라우트 기반 파일 구조는 라우트별 페이지와 컴포넌트가 많지 않을 때 굉장히 유용한 파일 구조였던 것이다. 그렇게 파일 구조에 대해 관심을 갖기 시작했고, 아토믹 디자인에 대해 알게 되었다.

## 아토믹 디자인 기반 파일 구조

처음에 아토믹 디자인에 대해 공부할 때 “아토믹 디자인 시스템”이라고 적어놓은 글들이 많아서 디자인 시스템 개념과 혼동이 되었는데, 아토믹 디자인은 디자인 시스템과 다른 개념이라고 한다. 디자인 시스템 안에서 활용될 수 있는 어떤 ‘디자인 방법론’ 인 것이지 시스템이 아닌 것이다. 유명한 디자인 시스템으로는 [Ant Design](https://ant.design/), 구글의 [Material Design](https://m3.material.io/), [IBM Design Langauge](https://www.ibm.com/design/language/) 등이 있는데, 어떤 디자인 시스템들은 아토믹 디자인 원칙들을 사용한 것이다.

### 아토믹 디자인 기준을 알아보자

![img](/images/developments/atomic-design-flow.png)

이보다도 간단할 수 없는데, 일단 내가 구분하고 있는 기준에 대해 작성해보았다.

- `atom`: **더 이상 분해할 수 없는** 기본 컴포넌트
- `molescule`: 여러 개의 atom을 결합해 **자신의 고유한 특성**을 가진 컴포넌트
  - search form molescule (label + input + button)
- `organism`: 명확한 영역과 **특정 페이지 컨텍스트**를 가지며 재사용성이 낮다
  - header (logo + navigation + search form)
- `template`: 정보가 들어가있지 않은 전체 페이지 컴포넌트
- `page`: 정보가 들어간 완성된 전체 페이지

### 아토믹 디자인을 활용해 본 경험

앞서 말했듯 독서모임 한페이지 레코드북라는 프로젝트에서 라우트 기반 파일 구조를 사용했다가 경로가 10개가 넘으면서 이건 아니라는 생각이 들었다. 이 프로젝트는 내가 참여하고 있는 독서모임에서 실제로 사용하고 있는 서비스 어플리케이션이기 때문에 계속해서 유지보수를 해야했고, 앞으로 라우트 페이지가 더 생길수도 있었다. 앞으로의 유지보수와 생산성 측면을 생각한다면 파일 구조를 갈아엎어야겠다는 생각을 하게되었다. 당시 공부했던 아토믹 디자인 원칙을 기반으로 다시 컴포넌트들을 리팩토링했고, 분류했다.

```bash
📦src
 ┣ 📂components
 ┃ ┣ 📂atoms
 ┃ ┣ 📂molecules
 ┃ ┗ 📂organisms
 ┃ ┗ 📂templates
 ┗ routes # =pages 전체 페이지 컴포넌트가 있는 폴더
```

- Atoms

  atoms 컴포넌트에서 가장 많이 만들어지고 공통적으로 사용되는 대표적인 컴포넌트인 button, input 같은 컴포넌트들이 여러개 생기다 보니 버튼은 버튼끼리 인풋은 인풋끼리 모아놓은 폴더를 따로 만들었고 최근까지도 이렇게 사용하고 있다.

  atoms 폴더에 들어가는 컴포넌트들은 더이상 쪼개지지 않아야하고 전역에서 가장 많이 재사용되는 컴포넌트여야 한다.

  ```bash
  📦atoms
   ┣ 📂button # 기본 여러 스타일의 버튼들
   ┣ 📂input # 기본 여러 스타일의 버튼들
   ┣ 📜BookThumbnailImg.tsx
   ┣ 📜GuideLine.tsx
   ┣ 📜Modal.tsx # 모달 기본 틀
   ┣ 📜QuillEditor.tsx
   ┣ 📜ScrollToTop.tsx
   ┣ 📜Subtitle.tsx
   ┣ 📜UserImg.tsx
   ┗ 📜UserNameBox.tsx
  ```

> Atom으로 나눈 기준은 정리하자면 다음과 같다.
>
> 1.  더 이상 쪼갤 수 없을 정도의 작은 컴포넌트이다.
> 2.  전역에서 가장 많이 재사용되는 컴포넌트이다.

- Molecules

  다음은 molecules 폴더인데, molecules는 여러개의 atom 컴포넌트가 결합되어 그래서 자신만의 고유한 특성을 가진다. 이 고유한 특성을 가진다는 뜻은 어떤 특정 페이지에 귀속된다는 뜻이 아니고, SRP(Single Responsibility Principle)원칙에 따라 **특정 한가지 일**을 맡는 것을 뜻한다. 예를 들어 사용자 정보를 입력하는 라벨, 인풋, 버튼이 함께 있는 폼(Form) 컴포넌트, 아니면 좋아요 버튼과 좋아요를 누른 사용자 리스트가 함께있는 좋아요 컴포넌트 등등이 있다. 특정 페이지 맥락에 귀속되는 게 아니므로 여러 곳에 재사용이 가능하다.

  그런데 헷갈렸던 부분이 있었다. 어떤 컴포넌트는 여러개의 Atom으로 만들어졌고 고유한 특성을 가졌는데 하나의 특정 페이지에서만 사용된다. 그래서 본래는 Molecule라고 생각되었지만, 계속 특정 페이지에서만 사용된다는 점 때문에 계속 Organism으로 분류해야되는 건 아닌지 헷갈렸다.

  ![독서모임 한페이지 박스 1](/images/developments/consideration-of-file-structure/molecules-1.png)

  ![독서모임 한페이지 박스 3](/images/developments/consideration-of-file-structure/molecules-3.png)

  ![독서모임 한페이지 박스 2](/images/developments/consideration-of-file-structure/molecules-2.png)

  ```bash
  📦molecules
   ┣ 📜ChallengeBookBox.tsx
   ┣ 📜ClubBookBox.tsx
   ┣ 📜HistoryClubBookBox.tsx
   ┣ 📜RecommendedBookBox.tsx
   ┣ 📂modal
  ```

  위에서 BookBox 컴포넌트들의 생김새는 아래와 같다.

  위의 박스들은 각각 하나의 페이지에서만 사용되고 있다. 따라서 특정 컨텍스트 맥락을 갖고 있다고 생각해서 Organisms로 분류하게 될 수도 있다. 하지만 나의 경우에는, 이런 컴포넌트들은 특정 맥락을 염두에 놓고 개발한 컴포넌트가 아니고, 그냥 특정 UI 패턴 컴포넌트일 뿐 충분히 다른 곳에서 사용된다고 하면 사용될 수 있는 컴포넌트였다. 따라서 재사용이 가능하다고 하면 일단 molecules로 분류했다.

  또한 Organism는 페이지 단위에서 명확한 "영역"을 가져야 한다는 조건이 있기 때문에 Molecule로 분류 가능하다. 위와 같은 박스 컴포넌트의 경우 Molecules 컴포넌트다. Molecules 컴포넌트들은 보통 특정 기능이나 UI 패턴을 나타내서 재사용되는 컴포넌트다, 어떤 컴포넌트는 특정 페이지에서만 사용된다 하더라도 영역 단위의 컴포넌트가 아니라면 Molecule 컴포넌트이다.

  > 사실 Molecules와 Organisms는 가장 많이 혼용되어 사용된다. 이를 방지하기 위해 정한 기준을 정리하자면 다음과 같다.
  >
  > Molecule 컴포넌트
  >
  > 1.  특정 컨텍스트 맥락에 얽매이지 않는다.
  >     → 여러곳에서 재사용 가능하다.
  >
  > 2.  특정 기능(ex. 탭, 체크박스), UI 패턴을 나타내는 컴포넌트이다.
  > 3.  SRP(Single Responsibility Principle)원칙에 따라 한가지 일을 해야 한다.
  > 4.  영역 단위가 아니다.
  >     → 이 부분은 Organisms에서 더 자세히 다뤄보자.

- Organisms

  위에서 잠깐 말을 했는데, Organisms는 특정 페이지의 확실한 영역을 나타내는 컴포넌트들이다. 대표적으로 로고와 네비게이션 메뉴 등등이 있는 상단 네비게이션 헤더 컴포넌트를 예시로 들 수 있다. 이런 네비게이션 헤더 컴포넌트들을 페이지에서 확실한 영역을 나타내고 있다. 특정 페이지에서 확실한 영역을 갖게 되기 때문에 재사용성이 낮아진다.

  다음

  > Organisms의 기준에 대해 정리하자면,
  >
  > 1. 특정 컨텍스트 맥락을 가진다.
  > 2. 또한 페이지에서 확실한 영역을 가진다.
  >    이 영역에 대한 부분은 또 사람마다 주관적이다. 나같은 경우에는 특정 html 태그를 중심으로 Organisms로 분류했다. `header`, `section`, `ul`, `ol`, `aside`, `footer`, `nav` 같이 어떤 자식 요소나 리스트 아이템들을 같이 묶는 태그를 가장 상위 요소로 사용하는 컴포넌트일 때 Organisms로 분류했다. 분명히 잊지 말아야할 건 특정 컨텍스트 맥락을 가질 때라는 것이다.

- Templetes

  템플릿 컴포넌트는 이제 Atom, Molecules, Organisms 컴포넌트들을 배치해서 하나의 페이지를 구성하게 된다. 페이지 수준에서 프레임 구성을 잡는 것이고 데이터는 들어오지 않은 page 수준의 스켈레톤이라고 한다. 따라서 데이터가 없는 경우에 보여줄 템플릿과 콘텐츠가 넘친 경우의 템플릿 등등 여러 페이지 구성을 보여줄 수 있는 단위로 이해했다.

- Pages

  가장 큰 단위인 Pages는 이제 데이터가 들어와 실제 콘텐츠가 보이게 되는 단위이며, 실제 사용자가 보게 되는 화면이다. Pages에서 여러 종류의 데이터를 Template 단위로 보내주게 된다.

### 그런데 아토믹 디자인이 불편했던 이유

- Template은 제대로 활용하지 못했다.

  Template은 데이터 없이 페이지의 전체 프레임을 보여준다고 정의되어 있다. 하지만 Molecules와 Organisms 단위에서 데이터를 가져오게 되는 것도 있는데 데이터 없이 전체 페이지를 구성한다는 것이 약간 이해가 안갔다. 아토믹 디자인 창시자인 Brad frost도 꼭 단계별로 컴포넌트가 나아가야한다고 하지 않는다. 그저 명확한 기준을 잡고 컴포넌트를 분류하기만 하면 된다는 것이다. 하지만 이 단위를 나누는 기준이 굉장히 주관적이라서 팀 프로젝트인 경우 팀원들간 이 주관을 맞추는 데 의사소통 비용이 많이 들어가겠다는 생각이 들었다.

- 개발자마다 아토믹 디자인 구분 기준이 주관적이다.

  지금은 좀 지나간 것 같은데 조금 예전에 아토믹 디자인이 엄청 핫했을 때는 여러 개발자들에게 “아토믹 디자인에서 각각의 기준을 어떻게 정하시나요?” 라는 질문이 엄청 많았었다. 그리고 몇몇 분들은 나는 기준을 이렇게 정한다라고 대답해주시는 분들도 많았지만, 어떤 개발자들은 각각 기준이 달라서 팀으로 개발할 때 더 많이 논의해야하고 오히려 더 꼬이는 경우가 있다고 말씀하시는 분들도 많았다. 특히 다들 molecules과 organism 사이에서 헷갈리는 경우들이 많은 것 같다.

위처럼 불편한 점이 있지만, 특히 컴포넌트를 기반으로 개발을 한다면 아토믹 디자인은 분명 좋은 선택일 것 같다. 뭔가 초기에 갈팡질팡하다가 시간이 지나면 좀 더 숙련되고 능숙하게 컴포넌트를 배분하게되는 것 같다. 또한 컴포넌트 기반이기 때문에 스토리북과 함께 사용하면 굉장히 좋다고 한다.

## 추가로 파일 이름은?

> 콜로케이션(colocation)
>
> : 콜로케이션(colocation)은 코드와 관련된 파일들을 유사한 기능 또는 모듈에 가깝게 두는 프로그래밍 관행이다.

따라서 같은 컨텍스트를 가지는 경우 앞에 이름을 똑같이 만들었다.

```bash
📦molecules
 ┣ 📜Post.tsx
 ┣ 📜PostEditDeleteBox.tsx
 ┣ 📜PostFooter.tsx
 ┣ 📜PostHeader.tsx
 ┣ 📜PostRecommendedBook.tsx
 ┣ 📜SearchedBookDesc.tsx
 ┣ 📜TabContentBox.tsx
 ┣ 📜TabListOnTop.tsx
 ┣ 📜VoteBox.tsx
 ┣ 📜VoteDetailItem.tsx
 ┣ 📜VoteDetailItemPercent.tsx
 ┣ 📜VoteDetailReasonDetails.tsx
 ┣ 📜VoteModalAddItem.tsx
 ┗ 📜VoteModalItems.tsx
```

요런식으루~!

지금까지 여러 프로젝트를 진행하면서 파일 구조에 대해 느꼈던 점들을 정리해보았다. 마지막으로 폴더를 구분하는 기준에서 라우트 기준, 아토믹 디자인 기준 이외에도 기능별로 폴더를 구분하는 방식(Feature Driven Development) 등등도 있었다. 하지만 아직 기능별로 폴더를 구분한 프로젝트가 없어서 이 글에서 적어보진 않았는데, 이 방식도 굉장히 많이 활용되고 있다. 좀 규모가 있는 프로젝트를 한다면 다음에 이 파일 구조 방식을 사용해봐야겠다는 생각이 들었다.
