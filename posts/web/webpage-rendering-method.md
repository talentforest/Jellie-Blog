## 다양한 웹페이지 렌더링 방법 등장

웹 기술이 발전하고 관련 도구가 발전하기 시작하면서 다양한 렌더링 방법들이 등장했다. 과거의 전통적인 방식이었던 서버 사이드 렌더링 방식(SSR)을 넘어서 이제는 CSR, 그리고 비교적 최근에는 SSG, ISR까지 다양한 용어와 렌더링 방식이 생겨나는 중이다. 그리고 React나 Next.js, Gatsby와 같이 다양한 렌더링 방식을 사용할 수 있도록 도와주는 라이브러리와 프레임워크들도 등장하고 있다.

이것을 풀어서 다시 생각해보면, 웹페이지 렌더링 방법은 점점 더 다양해지고 세분화되는 중이다. 이렇게 다양하게 웹페이지를 렌더링할 수 있는 방법이 생겨난 만큼 어떤 프로젝트를 시작할 때 어떤 방식이 가장 좋을 지 최적의 선택을 하는 것도 정말 중요해졌다. 따라서 이번 글에서는 각 렌더링 방식에 대해 정확히 파악하고, 각 렌더링의 장단점과 어떤 상황에서 쓰면 알맞을지에 대해 생각해보려고 한다.

## MPA와 SPA

SPA(Single Page Application)와 MPA(Multi-Page Application)는 다음에 이야기할 CSR, SSR 등등 렌더링 방식과는 다른 개념이다. 이 개념을 먼저 알아보는 이유는 MPA와 SPA가 다음에 나올 렌더링 방식들과 밀접한 관계를 갖고 있는 개념이기 때문이다.

MPA와 SPA는 **웹 애플리케이션의 아키텍쳐 개념**을 나타낸 것으로, 애플리케이션에서 페이지 구조가 어떻게 구성되고 어떻게 서버에서 전달되어 사용자에 표시되는지를 나타낸 개념이라고 볼 수 있다.

### MPA: Multiple Page Application

> 여러개의 HTML 페이지로 구성되어 각 페이지가 독립적으로 서버에 의해 로드되는 어플리케이션

MPA는 지금처럼 웹기술이 발전하기 이전에 전통적으로 사용되어왔던 방식이다. MPA 웹 어플리케이션은 여러개의 HTML 페이지들이 준비되어있으며, 사용자가 주소에 접속하면 특정 페이지에 대한 요청을 서버에 보내고 서버에 이미 배포되어 있는 데이터를 HTML 문서를 브라우저에 보내면서 정적 페이지가 생성된다.

MPA은 SSR로 작동하며 빠른 초기 로딩이 가능하다. 또한 HTML에 실제 화면에 보여질 데이터가 들어가 있기 때문에 검색 엔진 최적화(SEO)에 대해 장점이 있다. 하지만 단점도 있는데, 사용자가 페이지를 이동할 때마다 처음부터 다시 페이지가 그려지기 때문에 화면 깜빡임이 생긴다는 점이다. 또한 페이지에 데이터가 많은 경우 새로고침을 할 때마다 사용자는 똑같이 기다려야 하고, 이는 사용자에게 좋은 사용자 경험을 주지 못했다.

| MPA 장점                                                                                             | MPA 단점                                                                                                                                                         |
| ---------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <ul><li>빠른 초기 로딩</li><li>SEO에 최적화.</li><li>중요 코드가 노출되지 않아 보안에 유리</li></ul> | <ul><li>새로고침될 때 화면 깜빡임</li><li>정적 콘텐츠 데이터가 많은 경우 TTV가 길어짐</li><li>매번 처음부터 다시 로드</li><li>클라이언트와 서버가 결합</li></ul> |

그러나 계속해서 인터넷이 발전하고 다양한 기기들의 성능이 좋아지면서 사용자와의 더 빠른 인터랙션이 요구되었고, 그에 따라 SPA를 더 많이 채택하여 사용하고 있는 추세이다.

### SPA: Single Page Application

> 하나의 HTML 페이지를 로드한 후, 하나의 페이지 내에서 변경되어야 하는 페이지 일부분만을 동적으로 로드하는 웹 어플리케이션

더 좋은 사용자 경험을 위해 새롭게 등장한 패러다임이다. SPA는 2005년 구글 맵스에서 하나의 페이지에서 동적으로 지도를 움직이는 SPA를 구현하면서 이후 많은 웹 애플리케이션에서 채택되었다고 한다. 이름에서부터 알 수 있듯이 웹 애플리케이션에 하나의 페이지만 있다.

| SPA 장점                                                                                                                  | SPA 단점                                                                                                                                  |
| ------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |
| <ul><li>사용자와의 인터랙션이 좋다.</li><li>로컬 데이터를 캐시할 수 있다.</li><li>클라이언트와 서버가 분리된다.</li></ul> | <ul><li>SEO가 좋지 않다.</li><li>초기 구동 속도가 좋지 않다(TTV가 느리다).</li><li>사용자에게 코드가 노출되어 보안상 좋지 않다.</li></ul> |

또한 SPA는 CSR과 자주 같이 등장하다보니 같은 개념으로 혼동하는데 SPA는 앞서 말했듯 웹 어플리케이션의 아키텍쳐를 나타내는 개념이며, CSR은 브라우저에서 페이지가 렌더링되는 방식을 나타내는 개념으로 차이가 있다는 것을 알아둘 필요가 있다.

## 다양한 렌더링 방식들

MPA와 SPA에 대해 알아보았으니 이제 다양한 렌더링 방식들에 대해 알아보자.

### CSR

> CSR: Client Side Rendering
>
> 브라우저가 주체가 되어 서버로부터 HTML, CSS, 자바스크립트 등 모든 리소스를 다운받고 동적으로 돔을 생성하여 이후 페이지 일부만 변경하는 렌더링 방식. 보통 React.js나 Vue.js 라이브러리를 쓰면 CSR을 사용하게 된다.

#### CSR 작동 과정

1. 브라우저는 서버에 HTML, CSS, JavaScript 데이터를 요청하고 서버는 응답하여 전송한다.

   - 이때 HTML은 비어있다.

2. 브라우저는 서버로부터 응답받은 리소스 로딩을 끝내면 동적으로 돔을 생성하여 화면을 렌더링한다.

3. 첫 화면이 렌더링된 이후에는 변경되어야 하는 페이지의 일부분만 동적으로 변경한다.

브라우저는 서버에서 어플리케이션을 구동하는 프레임워크나 라이브러리의 소스 코드를 포함한 모든 리소스를 다운로드 받는다. 브라우저는 서버에서 이 모든 리소스 로딩을 전부 끝내야 렌더링을 하기 때문에 초기 구동 시간이 길어지며 TTV가 느리다는 특징이 있다. 그리고 자바스크립트 파일이 커지면 커질수록 사용자는 하얀 빈화면을 보게 될 수 있다. 또 HTML은 비어 있기 때문에 검색 엔진 최적화(SEO)에 좋지 않다.

하지만 CSR은 초기 구동 시간이 걸리는 것을 제외하면 로딩 이후 변경하고자 하는 페이지 일부만 변경하면 되기 때문에 사용자와의 인터랙션이 빠르다. 또한 CSR은 빈 HTML만 보내주면 되기 때문에 서버 부하가 적다. 장단점이 SSR 방식과 거의 반대라고 보면 된다.

#### CSR 장단점 정리

| 장점                                                                 | 단점                                                                                                |
| -------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------- |
| <ul><li>사용자와의 인터랙션 및 경험</li><li>서버 부하 감소</li></ul> | <ul><li>초기 로딩 지연 (TTV가 느리다)</li><li>자바스크립트 파일 크기와 복잡성</li><li>SEO</li></ul> |

### SSR

> SSR: Server Side Rendering
>
> 브라우저가 서버에 컨텐츠 요청하고 서버가 응답하여 HTML 페이지를 보여준다. 이후 자바스크립트를 다운받아 페이지에 연결한다. 보통 Next.js, Gatsby.jts 프레임워크를 쓰면 SSR을 사용하게 된다.

#### SSR 작동 방식

1. 사용자가 주소에 접속하면 브라우저가 서버에 컨텐츠를 요청하면 서버가 필요한 데이터를 모두 가져와 HTML 파일을 만들고 클라이언트에 보낸다.

2. 클라이언트는 서버에서 만들어진 HTML 파일을 화면에 렌더링한다.

3. 이후 브라우저는 자바스크립트를 다 다운받으면 페이지에 연결한다.

SSR에도 명확한 단점이 있는데, SSR은 서버에서 HTML이 만들어지기 때문에 사용자가 많아질수록 많은 요청으로 인해 서버 부하가 발생할 수 있고, 여전히 화면 깜빡임이 발생할 수 있다. SSR은 서버에서 만들어진 HTML으로 화면을 렌더링하고, 이후 자바스크립트를 다운받아 페이지와 연결(hydration)하기 때문에 사용자 인터렉션이 느리다. 예를 들어 화면에 어떤 버튼이 있다고 할 때, 리소스가 많아질 경우 사용자에게 버튼은 보이지만 버튼을 클릭해도 아무 동작을 하지 않는 현상이 발생할 수 있다.

하지만 SSR은 서버에서 HTML 페이지를 렌더링하기 때문에 초기 화면을 빠르게 볼 수 있고, 모든 컨텐츠가 HTML내에 담겨져 있기 때문에 검색 엔진 최적화(SEO)에 좋다.

#### SSR 장단점 정리

| 장점                                                         | 단점                                                                                          |
| ------------------------------------------------------------ | --------------------------------------------------------------------------------------------- |
| <ul><li>SEO</li><li>초기 화면을 빠르게 볼 수 있다.</li></ul> | <ul><li>화면 깜박임</li><li>느린 초기 사용자 인터랙션. (느린 TTI)</li><li>서버 부하</li></ul> |

### SSG

> SSG: Static Site Generation
>
> SSG는 빌드될 때 HTML이 생성되어 렌더링한다. (요청마다 변화 X)

#### SSG 작동 방식

1. 빌드할 때 서버는 HTML을 미리 만들어둔다.

2. 사용자 접속 시에 만들어져 있는 HTML을 클라이언트 보내고 렌더링한다.

3. 재접속시 CDN에 캐시되어서 더욱 빠른 렌더링이 가능하다.

정적 사이트에 가장 적절한 렌더링으로 서버가 언제 화면을 렌더링하느냐에 따라 SSR과 SSG가 달라진다. 빌드할 때 페이지를 만들어두고, 이 페이지를 클라이언트가 요청할 떄 서버에서 이 페이지를 제공한다. 매 요청마다 서버에서 만들어져야 하는 SSR과 달리 SSG는 미리 생성된 HTML 하나를 계속 재사용하기 때문에 서버 부하가 적고, CDN에 캐시가 되어 더욱 빠른 렌더링이 가능하다.

#### SSG 장단점 정리

| 장점                                                                                                                          | 단점                                                                      |
| ----------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------- |
| <ul><li>CDN에 캐시된다.</li><li>페이지 로딩 시간(TTV)이 빠르다.</li><li>SEO 최적화가 좋다.</li><li>보안이 뛰어나다.</li></ul> | <ul><li>데이터가 정적이다.</li><li>사용자별 정보 제공이 어렵다.</li></ul> |

사용해야 할 곳 : 데이터가 거의 바뀌지 않는 페이지에 적합하다. 모든 사용자들에게 동일한 데이터를 보여줄 때 적합하다.

### ISR

> ISR: Incremental Static Regeneration
>
> SSG 방식와 같지만 주기적으로 렌더링한다.

#### ISR 작동 방식

1. SSG 작동 방식과 동일

2. 일정 시간마다 다시 페이지를 빌드하여 업데이트된 페이지를 렌더링한다.

데이터가 변경된 경우 다시 빌드해야 하는 SSG와 달리 ISR은 일정 시간마다 서버에서 페이지를 다시 빌드하고 업데이트된 페이지를 렌더링한다는 특징이 있다.

#### ISR 장단점 정리

| 장점                                                                    | 단점                                                                                         |
| ----------------------------------------------------------------------- | -------------------------------------------------------------------------------------------- |
| <ul><li>기존 SSG의 장점들</li>+ 데이터가 주기적으로 업데이트 된다.</ul> | <ul><li>여전히 실시간 데이터는 아니다.</li><li>여전히 사용자별 정보 제공이 어렵다.</li></ul> |

### 하이브리드 렌더링

#### 하이브리드 렌더링 작동 방식

하이브리드 렌더링은 여러가지 렌더링 방식들을 혼합하여 사용하는 것을 뜻한다. 이 하이브리드 렌더링은 Next.js에서 잘 지원해주고 있는데, 만약 어떤 쇼핑몰 사이트가 생각할 때,

- 검색 엔진에 잘 노출되면 상품 목록 페이지는 SSR
- 데이터가 잘 변하지 않는 쇼핑몰 회사 소개와 정보를 보여주는 곳에는 SSG

그렇다면 이 하이브리드 렌더링이 가장 좋은 방법이 아닌가 생각이 들수도 있지만 개발 공수가 많이 든다는 점에서 개발 효율이 떨어질 수 있다.

#### 하이브리드 렌더링 장단점 정리

| 장점                                      | 단점           |
| ----------------------------------------- | -------------- |
| 페이지 성격에 맞춰 최적화된 렌더링이 가능 | 개발 공수 증가 |

&nbsp;
&nbsp;

각 렌더링 방식의 작동 방식과 장단점에 대해 알아보았다. 정리하자면, SSR -> CSR -> 다양한 렌더링 방식 수순을 밟고 있는 것 같은데, 그만큼 개발자들이 어떤 페이지를 개발할 때 선택할 수 있는 방식의 범위도 넓어졌다. 꼭 어떤 정답이 있는 것은 아니기 때문에 앞서 이야기한 각 렌더링의 장단점을 충분히 살펴보고, 페이지의 성격에 맞게 렌더링 방식을 선택하면 되지 않을까 싶다.

&nbsp;
&nbsp;

&nbsp;
&nbsp;

참고

- [poiemaweb: 5.37 SPA & Routing](https://poiemaweb.com/js-spa)
- [블로그:[Next.js] CSR, SSR, ISR, SSG, 하이브리드(Hybrid) 렌더링, 하이드레이션(Hydration)](https://medium.com/@zero86/next-js-csr-ssr-isr-ssg-%ED%95%98%EC%9D%B4%EB%B8%8C%EB%A6%AC%EB%93%9C-hybrid-%EB%A0%8C%EB%8D%94%EB%A7%81-%ED%95%98%EC%9D%B4%EB%93%9C%EB%A0%88%EC%9D%B4%EC%85%98-hydration-e2f6a487fe95)
